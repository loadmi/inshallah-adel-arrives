<div class="container">
  <h1>Statistics Dashboard</h1>
  <p class="subtitle">Analyzing Adel's temporal patterns</p>

  @if (loading()) {
    <div class="loading">Loading statistics...</div>
  }

  @if (error()) {
    <div class="alert alert-error">{{ error() }}</div>
  }

  @if (stats()) {
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">{{ stats()!.overall.totalEntries }}</div>
        <div class="stat-label">Total Entries</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ stats()!.overall.averageDelay }} min</div>
        <div class="stat-label">Average Delay</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ stats()!.overall.medianDelay }} min</div>
        <div class="stat-label">Median Delay</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ stats()!.overall.onTimePercentage | number:'1.0-1' }}%</div>
        <div class="stat-label">On Time (â‰¤5 min)</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ stats()!.overall.maxDelay }} min</div>
        <div class="stat-label">Maximum Delay</div>
      </div>

      <div class="stat-card">
        <div class="stat-value">{{ getTrendIcon() }}</div>
        <div class="stat-label">
          @if (stats()!.recentTrend.improving) {
            Improving!
          } @else {
            Getting worse...
          }
        </div>
      </div>
    </div>

    @if (stats()!.byDay.length > 0) {
      <div class="section">
        <h2>By Day of Week</h2>
        <div class="day-stats">
          @for (day of stats()!.byDay; track day.dayOfWeek) {
            <div class="day-row">
              <span class="day-name">{{ day.dayName }}</span>
              <div class="bar-container">
                <div class="bar" [style.width.%]="(day.averageDelay / stats()!.overall.maxDelay) * 100"></div>
              </div>
              <span class="day-value">{{ day.averageDelay }} min ({{ day.count }})</span>
            </div>
          }
        </div>
      </div>
    }
  }
</div>
