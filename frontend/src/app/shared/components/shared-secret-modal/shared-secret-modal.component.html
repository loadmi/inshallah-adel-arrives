<div class="modal-overlay" (click)="onClose()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="close-button" (click)="onClose()" aria-label="Close modal">&times;</button>
    
    @if (!isStarted()) {
      <div class="modal-header">
        <div class="security-badge">üõ°Ô∏è</div>
        <h2>Security Protocol ABBAP v4.2.0</h2>
      </div>
      <div class="modal-body intro-screen">
        <p class="scientific-explanation">
          To maintain the integrity of our high-precision temporal datasets, we must verify that you are not the individual known as <strong>Adel</strong>. 
        </p>
        <p class="scientific-explanation">
          Our proprietary <em>Advanced Biometric & Behavioral Analysis Protocol</em> will now evaluate your cultural alignment, micro-hesitations, and lateness-justification patterns. 
        </p>
        <p class="scientific-explanation">
          Failure to pass this verification will result in immediate exclusion from the recording interface. Please proceed with scientific rigor.
        </p>
        
        <button class="btn-primary" (click)="startQuiz()">
          Begin Verification
        </button>
      </div>
    } @else if (!isFinished()) {
      <div class="modal-header">
        <h2>Security Verification</h2>
        <p class="step-indicator">Question {{ currentStep() + 1 }} of {{ questions.length }}</p>
      </div>
      
      <div class="modal-body">
        <p class="question-text">{{ currentQuestion.text }}</p>
        
        <div class="answers-grid">
          @for (answer of getDisplayAnswers(); track $index) {
            <button class="answer-button" (click)="onAnswer($index)">
              {{ answer }}
            </button>
          }
        </div>
      </div>

      <div class="modal-footer">
        <button class="skip-button" (click)="onSkip()">
          Skip
        </button>
      </div>
    } @else if (!isAccessGranted()) {
      <div class="modal-header">
        <div class="security-badge denied">üö´</div>
        <h2>Subject Identified: ADEL-77-B</h2>
      </div>
      <div class="modal-body access-denied">
        <p class="scientific-explanation">
          <strong>Temporal Inconsistency Detected.</strong> Our analysis has confirmed a 99.8% match with the behavioral signature of the subject known as <em>Adel</em>.
        </p>
        <p class="scientific-explanation">
          Access to the recording interface has been restricted to prevent further contamination of our high-precision datasets. 
        </p>
        <p class="scientific-explanation funny-hint">
          Please return to the prediction dashboard. We recommend arriving at least 45 minutes early to compensate for your current temporal displacement.
        </p>
        
        <button class="btn-primary" (click)="onGoBack()">
          Return to Dashboard
        </button>
      </div>
    }
  </div>
</div>
